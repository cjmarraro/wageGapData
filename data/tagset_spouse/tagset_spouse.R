# Set working directory
# setwd()

new_data <- read.table('tagset_spouse.dat', sep=' ')
names(new_data) <- c('R0000100','R0155500','R0312710','R0482910','R0784300','R1024001','R1410701','R1780701','R2143801','R2352501','R2724701','R2973600','R3281600','R3571801','R3899300','R4314401','R4996001','R5650801','R6374901','R6917801','R7617300','R8325800','T0920800')

# Handle missing values
  new_data[new_data == -1] = NA  # Refused 
  new_data[new_data == -2] = NA  # Dont know 
  new_data[new_data == -3] = NA  # Invalid missing 
  new_data[new_data == -4] = NA  # Valid missing 
  new_data[new_data == -5] = NA  # Non-interview 

# If there are values not categorized they will be represented as NA
vallabels = function(data) {
  data$R0155500 <- cut(data$R0155500, c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,9999999.0), labels=c("0","1 TO 99","100 TO 199","200 TO 299","300 TO 399","400 TO 499","500 TO 599","600 TO 699","700 TO 799","800 TO 899","900 TO 999","1000 TO 9999999: 1000+"), right=FALSE)
  data$R0312710 <- cut(data$R0312710, c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,15000.0,20000.0,25000.0,50000.0,9999999.0), labels=c("0","1 TO 999","1000 TO 1999","2000 TO 2999","3000 TO 3999","4000 TO 4999","5000 TO 5999","6000 TO 6999","7000 TO 7999","8000 TO 8999","9000 TO 9999","10000 TO 14999","15000 TO 19999","20000 TO 24999","25000 TO 49999","50000 TO 9999999: 50000+"), right=FALSE)
  data$R0482910 <- cut(data$R0482910, c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,15000.0,20000.0,25000.0,50000.0,9999999.0), labels=c("0","1 TO 999","1000 TO 1999","2000 TO 2999","3000 TO 3999","4000 TO 4999","5000 TO 5999","6000 TO 6999","7000 TO 7999","8000 TO 8999","9000 TO 9999","10000 TO 14999","15000 TO 19999","20000 TO 24999","25000 TO 49999","50000 TO 9999999: 50000+"), right=FALSE)
  data$R0784300 <- cut(data$R0784300, c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,15000.0,20000.0,25000.0,50000.0,9999999.0), labels=c("0","1 TO 999","1000 TO 1999","2000 TO 2999","3000 TO 3999","4000 TO 4999","5000 TO 5999","6000 TO 6999","7000 TO 7999","8000 TO 8999","9000 TO 9999","10000 TO 14999","15000 TO 19999","20000 TO 24999","25000 TO 49999","50000 TO 9999999: 50000+"), right=FALSE)
  data$R1024001 <- cut(data$R1024001, c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,15000.0,20000.0,25000.0,50000.0,9999999.0), labels=c("0","1 TO 999","1000 TO 1999","2000 TO 2999","3000 TO 3999","4000 TO 4999","5000 TO 5999","6000 TO 6999","7000 TO 7999","8000 TO 8999","9000 TO 9999","10000 TO 14999","15000 TO 19999","20000 TO 24999","25000 TO 49999","50000 TO 9999999: 50000+"), right=FALSE)
  data$R1410701 <- cut(data$R1410701, c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,15000.0,20000.0,25000.0,50000.0,9999999.0), labels=c("0","1 TO 999","1000 TO 1999","2000 TO 2999","3000 TO 3999","4000 TO 4999","5000 TO 5999","6000 TO 6999","7000 TO 7999","8000 TO 8999","9000 TO 9999","10000 TO 14999","15000 TO 19999","20000 TO 24999","25000 TO 49999","50000 TO 9999999: 50000+"), right=FALSE)
  data$R1780701 <- cut(data$R1780701, c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,15000.0,20000.0,25000.0,50000.0,9999999.0), labels=c("0","1 TO 999","1000 TO 1999","2000 TO 2999","3000 TO 3999","4000 TO 4999","5000 TO 5999","6000 TO 6999","7000 TO 7999","8000 TO 8999","9000 TO 9999","10000 TO 14999","15000 TO 19999","20000 TO 24999","25000 TO 49999","50000 TO 9999999: 50000+"), right=FALSE)
  data$R2143801 <- cut(data$R2143801, c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,15000.0,20000.0,25000.0,50000.0,9999999.0), labels=c("0","1 TO 999","1000 TO 1999","2000 TO 2999","3000 TO 3999","4000 TO 4999","5000 TO 5999","6000 TO 6999","7000 TO 7999","8000 TO 8999","9000 TO 9999","10000 TO 14999","15000 TO 19999","20000 TO 24999","25000 TO 49999","50000 TO 9999999: 50000+"), right=FALSE)
  data$R2352501 <- cut(data$R2352501, c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,15000.0,20000.0,25000.0,50000.0,9999999.0), labels=c("0","1 TO 999","1000 TO 1999","2000 TO 2999","3000 TO 3999","4000 TO 4999","5000 TO 5999","6000 TO 6999","7000 TO 7999","8000 TO 8999","9000 TO 9999","10000 TO 14999","15000 TO 19999","20000 TO 24999","25000 TO 49999","50000 TO 9999999: 50000+"), right=FALSE)
  data$R2724701 <- cut(data$R2724701, c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,15000.0,20000.0,25000.0,50000.0,9999999.0), labels=c("0","1 TO 999","1000 TO 1999","2000 TO 2999","3000 TO 3999","4000 TO 4999","5000 TO 5999","6000 TO 6999","7000 TO 7999","8000 TO 8999","9000 TO 9999","10000 TO 14999","15000 TO 19999","20000 TO 24999","25000 TO 49999","50000 TO 9999999: 50000+"), right=FALSE)
  data$R2973600 <- cut(data$R2973600, c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,15000.0,20000.0,25000.0,50000.0,9999999.0), labels=c("0","1 TO 999","1000 TO 1999","2000 TO 2999","3000 TO 3999","4000 TO 4999","5000 TO 5999","6000 TO 6999","7000 TO 7999","8000 TO 8999","9000 TO 9999","10000 TO 14999","15000 TO 19999","20000 TO 24999","25000 TO 49999","50000 TO 9999999: 50000+"), right=FALSE)
  data$R3281600 <- cut(data$R3281600, c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,15000.0,20000.0,25000.0,50000.0,9999999.0), labels=c("0","1 TO 999","1000 TO 1999","2000 TO 2999","3000 TO 3999","4000 TO 4999","5000 TO 5999","6000 TO 6999","7000 TO 7999","8000 TO 8999","9000 TO 9999","10000 TO 14999","15000 TO 19999","20000 TO 24999","25000 TO 49999","50000 TO 9999999: 50000+"), right=FALSE)
  data$R3571801 <- cut(data$R3571801, c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,15000.0,20000.0,25000.0,50000.0,9999999.0), labels=c("0","1 TO 999","1000 TO 1999","2000 TO 2999","3000 TO 3999","4000 TO 4999","5000 TO 5999","6000 TO 6999","7000 TO 7999","8000 TO 8999","9000 TO 9999","10000 TO 14999","15000 TO 19999","20000 TO 24999","25000 TO 49999","50000 TO 9999999: 50000+"), right=FALSE)
  data$R3899300 <- cut(data$R3899300, c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,15000.0,20000.0,25000.0,50000.0,9999999.0), labels=c("0","1 TO 999","1000 TO 1999","2000 TO 2999","3000 TO 3999","4000 TO 4999","5000 TO 5999","6000 TO 6999","7000 TO 7999","8000 TO 8999","9000 TO 9999","10000 TO 14999","15000 TO 19999","20000 TO 24999","25000 TO 49999","50000 TO 9999999: 50000+"), right=FALSE)
  data$R4314401 <- cut(data$R4314401, c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,15000.0,20000.0,25000.0,50000.0,9999999.0), labels=c("0","1 TO 999","1000 TO 1999","2000 TO 2999","3000 TO 3999","4000 TO 4999","5000 TO 5999","6000 TO 6999","7000 TO 7999","8000 TO 8999","9000 TO 9999","10000 TO 14999","15000 TO 19999","20000 TO 24999","25000 TO 49999","50000 TO 9999999: 50000+"), right=FALSE)
  data$R4996001 <- cut(data$R4996001, c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,15000.0,20000.0,25000.0,50000.0,9.9999999E7), labels=c("0","1 TO 999","1000 TO 1999","2000 TO 2999","3000 TO 3999","4000 TO 4999","5000 TO 5999","6000 TO 6999","7000 TO 7999","8000 TO 8999","9000 TO 9999","10000 TO 14999","15000 TO 19999","20000 TO 24999","25000 TO 49999","50000 TO 99999999: 50000+"), right=FALSE)
  data$R5650801 <- cut(data$R5650801, c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,15000.0,20000.0,25000.0,50000.0,9.9999999E7), labels=c("0","1 TO 999","1000 TO 1999","2000 TO 2999","3000 TO 3999","4000 TO 4999","5000 TO 5999","6000 TO 6999","7000 TO 7999","8000 TO 8999","9000 TO 9999","10000 TO 14999","15000 TO 19999","20000 TO 24999","25000 TO 49999","50000 TO 99999999: 50000+"), right=FALSE)
  data$R6374901 <- cut(data$R6374901, c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,15000.0,20000.0,25000.0,50000.0,9.9999999E7), labels=c("0","1 TO 999","1000 TO 1999","2000 TO 2999","3000 TO 3999","4000 TO 4999","5000 TO 5999","6000 TO 6999","7000 TO 7999","8000 TO 8999","9000 TO 9999","10000 TO 14999","15000 TO 19999","20000 TO 24999","25000 TO 49999","50000 TO 99999999: 50000+"), right=FALSE)
  data$R6917801 <- cut(data$R6917801, c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,15000.0,20000.0,25000.0,50000.0,9.9999999E7), labels=c("0","1 TO 999","1000 TO 1999","2000 TO 2999","3000 TO 3999","4000 TO 4999","5000 TO 5999","6000 TO 6999","7000 TO 7999","8000 TO 8999","9000 TO 9999","10000 TO 14999","15000 TO 19999","20000 TO 24999","25000 TO 49999","50000 TO 99999999: 50000+"), right=FALSE)
  data$R7617300 <- cut(data$R7617300, c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,15000.0,20000.0,25000.0,50000.0,9.9999999E7), labels=c("0","1 TO 999","1000 TO 1999","2000 TO 2999","3000 TO 3999","4000 TO 4999","5000 TO 5999","6000 TO 6999","7000 TO 7999","8000 TO 8999","9000 TO 9999","10000 TO 14999","15000 TO 19999","20000 TO 24999","25000 TO 49999","50000 TO 99999999: 50000+"), right=FALSE)
  data$R8325800 <- cut(data$R8325800, c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,15000.0,20000.0,25000.0,50000.0,9.99999999E8), labels=c("0","1 TO 999","1000 TO 1999","2000 TO 2999","3000 TO 3999","4000 TO 4999","5000 TO 5999","6000 TO 6999","7000 TO 7999","8000 TO 8999","9000 TO 9999","10000 TO 14999","15000 TO 19999","20000 TO 24999","25000 TO 49999","50000 TO 999999999: 50000+"), right=FALSE)
  data$T0920800 <- cut(data$T0920800, c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0,10000.0,15000.0,20000.0,25000.0,50000.0,9.9999999E7), labels=c("0","1 TO 999","1000 TO 1999","2000 TO 2999","3000 TO 3999","4000 TO 4999","5000 TO 5999","6000 TO 6999","7000 TO 7999","8000 TO 8999","9000 TO 9999","10000 TO 14999","15000 TO 19999","20000 TO 24999","25000 TO 49999","50000 TO 99999999: 50000+"), right=FALSE)
  return(data)
}

varlabels <- c(    "ID# (1-12686) 79",
    "TOT INC SP WAGE AND SALRY P-C YR 79",
    "TOT INC SP WAGE AND SALRY P-C YR 80",
    "TOT INC SP WAGE AND SALRY P-C YR 81",
    "TOT INC SP WAGE AND SALRY P-C YR 82",
    "TOT INC WAGES AND SALRY P-C YR 83 (TRUNC)",
    "TOT INC WAGES AND SALRY P-C YR 84 (TRUNC)",
    "TOT INC SP WAGE AND SALRY P-C YR 85 (TRUNC)",
    "TOT INC SP WAGE AND SALRY P-C YR 86 (TRUNC)",
    "TOT INC SP WAGE AND SALRY P-C YR 87 (TRUNC)",
    "TOT INC SP WAGE AND SALRY P-C YR 88 (TRUNC)",
    "TOT INC SP WAGE AND SALRY P-C YR 89",
    "TOT INC SP WAGE AND SALRY P-C YR 90",
    "TOT INC PTNR WAGE AND SALRY P-C YR 91",
    "TOT INC SP WAGE AND SALRY P-C YR 92",
    "AMT SP REC'D 1992 FROM WAGES 93 (TRUNC)",
    "AMT SP REC'D 1993 FROM WAGES 94",
    "AMT SP REC'D 1995 FROM WAGES 96",
    "AMT SP REC'D 1997 FROM WAGES 1998",
    "AMT SP REC'D 1999 FROM WAGES 2000",
    "AMT SP REC'D 2001 FROM WAGES 2002",
    "AMT SPAR RECD 2003 FROM WAGES 2004",
    "AMT SP REC'D 2005 FROM WAGES 2006"
)

# Use qnames rather than rnums
qnames = function(data) {
  names(data) <- c("CASEID_1979","Q13-18_1979","Q13-18_1980","Q13-18_1981","Q13-18_1982","Q13-5_TRUNC_REVISED_1983","Q13-5_TRUNC_REVISED_1984","Q13-18_TRUNC_REVISED_1985","Q13-18_TRUNC_REVISED_1986","Q13-18_TRUNC_REVISED_1987","Q13-18_TRUNC_REVISED_1988","Q13-18_1989","Q13-18_1990","Q11-97_REVISED_1991","Q13-18_1992","R4314401_REVISED_1993","Q13-18_TRUNC_REVISED_1994","Q13-18_TRUNC_REVISED_1996","Q13-18_TRUNC_REVISED_1998","Q13-18_TRUNC_REVISED_2000","Q13-18_TRUNC_2002","Q13-18_TRUNC_2004","Q13-18_TRUNC_2006")
  return(data)
}

********************************************************************************************************

# Remove the '#' before the following line to create a data file called "categories" with value labels. 
#categories <- vallabels(new_data)

# Remove the '#' before the following lines to rename variables using Qnames instead of Reference Numbers
#new_data <- qnames(new_data)
#categories <- qnames(categories)

# Produce summaries for the raw (uncategorized) data file
summary(new_data)

# Remove the '#' before the following lines to produce summaries for the "categories" data file.
#categories <- vallabels(new_data)
#summary(categories)

************************************************************************************************************
