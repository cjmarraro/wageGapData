# Set working directory
# setwd()

new_data <- read.table('tageset_hrwage.dat', sep=' ')
names(new_data) <- c('R0000100','R0047010','R0263710','R0446810','R0702510','R0945610','R1256010','R1650810','R1923410','R2318210','R2526010','R2925010','R3127800','R3523500','R3728500','R4416800','R5079800','R5165200','R6478000','R7005700','R7702900','R8495200','T0986800')

# Handle missing values
  new_data[new_data == -1] = NA  # Refused 
  new_data[new_data == -2] = NA  # Dont know 
  new_data[new_data == -3] = NA  # Invalid missing 
  new_data[new_data == -4] = NA  # Valid missing 
  new_data[new_data == -5] = NA  # Non-interview 

# If there are values not categorized they will be represented as NA
vallabels = function(data) {
  data$R0047010 <- cut(data$R0047010, c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,9999999.0), labels=c("0","1 TO 99","100 TO 199","200 TO 299","300 TO 399","400 TO 499","500 TO 599","600 TO 699","700 TO 799","800 TO 899","900 TO 999","1000 TO 9999999: 1000+"), right=FALSE)
  data$R0263710 <- cut(data$R0263710, c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,9999999.0), labels=c("0","1 TO 99","100 TO 199","200 TO 299","300 TO 399","400 TO 499","500 TO 599","600 TO 699","700 TO 799","800 TO 899","900 TO 999","1000 TO 9999999: 1000+"), right=FALSE)
  data$R0446810 <- cut(data$R0446810, c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,9999999.0), labels=c("0","1 TO 99","100 TO 199","200 TO 299","300 TO 399","400 TO 499","500 TO 599","600 TO 699","700 TO 799","800 TO 899","900 TO 999","1000 TO 9999999: 1000+"), right=FALSE)
  data$R0702510 <- cut(data$R0702510, c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,9999999.0), labels=c("0","1 TO 99","100 TO 199","200 TO 299","300 TO 399","400 TO 499","500 TO 599","600 TO 699","700 TO 799","800 TO 899","900 TO 999","1000 TO 9999999: 1000+"), right=FALSE)
  data$R0945610 <- cut(data$R0945610, c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,9999999.0), labels=c("0","1 TO 99","100 TO 199","200 TO 299","300 TO 399","400 TO 499","500 TO 599","600 TO 699","700 TO 799","800 TO 899","900 TO 999","1000 TO 9999999: 1000+"), right=FALSE)
  data$R1256010 <- cut(data$R1256010, c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,9999999.0), labels=c("0","1 TO 99","100 TO 199","200 TO 299","300 TO 399","400 TO 499","500 TO 599","600 TO 699","700 TO 799","800 TO 899","900 TO 999","1000 TO 9999999: 1000+"), right=FALSE)
  data$R1650810 <- cut(data$R1650810, c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,9999999.0), labels=c("0","1 TO 99","100 TO 199","200 TO 299","300 TO 399","400 TO 499","500 TO 599","600 TO 699","700 TO 799","800 TO 899","900 TO 999","1000 TO 9999999: 1000+"), right=FALSE)
  data$R1923410 <- cut(data$R1923410, c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,9999999.0), labels=c("0","1 TO 99","100 TO 199","200 TO 299","300 TO 399","400 TO 499","500 TO 599","600 TO 699","700 TO 799","800 TO 899","900 TO 999","1000 TO 9999999: 1000+"), right=FALSE)
  data$R2318210 <- cut(data$R2318210, c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,9999999.0), labels=c("0","1 TO 99","100 TO 199","200 TO 299","300 TO 399","400 TO 499","500 TO 599","600 TO 699","700 TO 799","800 TO 899","900 TO 999","1000 TO 9999999: 1000+"), right=FALSE)
  data$R2526010 <- cut(data$R2526010, c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,9999999.0), labels=c("0","1 TO 99","100 TO 199","200 TO 299","300 TO 399","400 TO 499","500 TO 599","600 TO 699","700 TO 799","800 TO 899","900 TO 999","1000 TO 9999999: 1000+"), right=FALSE)
  data$R2925010 <- cut(data$R2925010, c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,9999999.0), labels=c("0","1 TO 99","100 TO 199","200 TO 299","300 TO 399","400 TO 499","500 TO 599","600 TO 699","700 TO 799","800 TO 899","900 TO 999","1000 TO 9999999: 1000+"), right=FALSE)
  data$R3127800 <- cut(data$R3127800, c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,9999999.0), labels=c("0","1 TO 99","100 TO 199","200 TO 299","300 TO 399","400 TO 499","500 TO 599","600 TO 699","700 TO 799","800 TO 899","900 TO 999","1000 TO 9999999: 1000+"), right=FALSE)
  data$R3523500 <- cut(data$R3523500, c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,9999999.0), labels=c("0","1 TO 99","100 TO 199","200 TO 299","300 TO 399","400 TO 499","500 TO 599","600 TO 699","700 TO 799","800 TO 899","900 TO 999","1000 TO 9999999: 1000+"), right=FALSE)
  data$R3728500 <- cut(data$R3728500, c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,9999999.0), labels=c("0","1 TO 99","100 TO 199","200 TO 299","300 TO 399","400 TO 499","500 TO 599","600 TO 699","700 TO 799","800 TO 899","900 TO 999","1000 TO 9999999: 1000+"), right=FALSE)
  data$R4416800 <- cut(data$R4416800, c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,9999999.0), labels=c("0","1 TO 99","100 TO 199","200 TO 299","300 TO 399","400 TO 499","500 TO 599","600 TO 699","700 TO 799","800 TO 899","900 TO 999","1000 TO 9999999: 1000+"), right=FALSE)
  data$R5079800 <- cut(data$R5079800, c(0.0,1.0,500.0,1000.0,1500.0,2000.0,2500.0,3000.0,3500.0,4000.0,4500.0,5000.0,9.9999999E7), labels=c("0","1 TO 499","500 TO 999","1000 TO 1499","1500 TO 1999","2000 TO 2499","2500 TO 2999","3000 TO 3499","3500 TO 3999","4000 TO 4499","4500 TO 4999","5000 TO 99999999: 5000+"), right=FALSE)
  data$R5165200 <- cut(data$R5165200, c(0.0,1.0,500.0,1000.0,1500.0,2000.0,2500.0,3000.0,3500.0,4000.0,4500.0,5000.0,9.9999999E7), labels=c("0","1 TO 499","500 TO 999","1000 TO 1499","1500 TO 1999","2000 TO 2499","2500 TO 2999","3000 TO 3499","3500 TO 3999","4000 TO 4499","4500 TO 4999","5000 TO 99999999: 5000+"), right=FALSE)
  data$R6478000 <- cut(data$R6478000, c(0.0,1.0,500.0,1000.0,1500.0,2000.0,2500.0,3000.0,3500.0,4000.0,4500.0,5000.0,9.9999999E7), labels=c("0","1 TO 499","500 TO 999","1000 TO 1499","1500 TO 1999","2000 TO 2499","2500 TO 2999","3000 TO 3499","3500 TO 3999","4000 TO 4499","4500 TO 4999","5000 TO 99999999: 5000+"), right=FALSE)
  data$R7005700 <- cut(data$R7005700, c(0.0,1.0,500.0,1000.0,1500.0,2000.0,2500.0,3000.0,3500.0,4000.0,4500.0,5000.0,9.9999999E7), labels=c("0","1 TO 499","500 TO 999","1000 TO 1499","1500 TO 1999","2000 TO 2499","2500 TO 2999","3000 TO 3499","3500 TO 3999","4000 TO 4499","4500 TO 4999","5000 TO 99999999: 5000+"), right=FALSE)
  data$R7702900 <- cut(data$R7702900, c(0.0,1.0,500.0,1000.0,1500.0,2000.0,2500.0,3000.0,3500.0,4000.0,4500.0,5000.0,9.9999999E7), labels=c("0","1 TO 499","500 TO 999","1000 TO 1499","1500 TO 1999","2000 TO 2499","2500 TO 2999","3000 TO 3499","3500 TO 3999","4000 TO 4499","4500 TO 4999","5000 TO 99999999: 5000+"), right=FALSE)
  data$R8495200 <- cut(data$R8495200, c(0.0,1.0,500.0,1000.0,1500.0,2000.0,2500.0,3000.0,3500.0,4000.0,4500.0,5000.0,9.9999999E7), labels=c("0","1 TO 499","500 TO 999","1000 TO 1499","1500 TO 1999","2000 TO 2499","2500 TO 2999","3000 TO 3499","3500 TO 3999","4000 TO 4499","4500 TO 4999","5000 TO 99999999: 5000+"), right=FALSE)
  data$T0986800 <- cut(data$T0986800, c(0.0,1.0,500.0,1000.0,1500.0,2000.0,2500.0,3000.0,3500.0,4000.0,4500.0,5000.0,9.9999999E7), labels=c("0","1 TO 499","500 TO 999","1000 TO 1499","1500 TO 1999","2000 TO 2499","2500 TO 2999","3000 TO 3499","3500 TO 3999","4000 TO 4499","4500 TO 4999","5000 TO 99999999: 5000+"), right=FALSE)
  return(data)
}

varlabels <- c(    "ID# (1-12686) 79",
    "HRP CURRENT/M-RCNT JOB 79",
    "HRP CURRENT/M-RCNT JOB 80",
    "HRP CURRENT/M-RCNT JOB 81",
    "HRP CURRENT/M-RCNT JOB 82",
    "HRP CURRENT/M-RCNT JOB 83",
    "HRP CURRENT/M-RCNT JOB 84",
    "HRP CURRENT/M-RCNT JOB 85",
    "HRP CURRENT/M-RCNT JOB 86",
    "HRP CURRENT/M-RCNT JOB 87",
    "HRP CURRENT/M-RCNT JOB 88",
    "HRP CURRENT/M-RCNT JOB 89",
    "HRP CURRENT/M-RCNT JOB 90",
    "HRP CURRENT/M-RCNT JOB 91",
    "HRP CURRENT/M-RCNT JOB 92",
    "HRLY RATE OF PAY CPS JOB 93",
    "HRLY RATE OF PAY CPS JOB 94",
    "HRLY RATE OF PAY JOB #1 96",
    "HRLY RATE OF PAY JOB #01 1998",
    "HRLY RATE OF PAY JOB #01 2000",
    "HRLY RATE OF PAY JOB# 1 2002",
    "HRLY RATE OF PAY JOB# 1 2004",
    "HRLY RATE OF PAY JOB #01 2006"
)

# Use qnames rather than rnums
qnames = function(data) {
  names(data) <- c("CASEID_1979","CPSHRP_1979","CPSHRP_1980","CPSHRP_1981","CPSHRP_1982","CPSHRP_1983","CPSHRP_1984","CPSHRP_1985","CPSHRP_1986","CPSHRP_1987","CPSHRP_1988","CPSHRP_1989","CPSHRP_1990","CPSHRP_1991","CPSHRP_1992","CPSHRP_1993","CPSHRP_1994","HRP1_1996","HRP1_1998","HRP1_2000","HRP1_2002","HRP1_2004","HRP1_2006")
  return(data)
}

********************************************************************************************************

# Remove the '#' before the following line to create a data file called "categories" with value labels. 
#categories <- vallabels(new_data)

# Remove the '#' before the following lines to rename variables using Qnames instead of Reference Numbers
#new_data <- qnames(new_data)
#categories <- qnames(categories)

# Produce summaries for the raw (uncategorized) data file
summary(new_data)

# Remove the '#' before the following lines to produce summaries for the "categories" data file.
#categories <- vallabels(new_data)
#summary(categories)

************************************************************************************************************
